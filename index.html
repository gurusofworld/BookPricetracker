<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Top Books in Discounted Price</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Find where to buy at a discount — Malayalam & English books across Indian stores (demo)">
  <style>
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    .badge{font-size:10px;padding:.15rem .45rem;border:1px solid rgb(226 232 240);background:#f8fafc;border-radius:.5rem}
    .ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <header class="bg-white border-b sticky top-0 z-20">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center gap-3">
      <div class="w-9 h-9 rounded-xl bg-indigo-600 text-white grid place-items-center font-bold">₹</div>
      <div>
        <h1 class="text-xl font-bold leading-tight">Top Books in Discounted Price</h1>
        <p class="text-xs text-indigo-700 font-medium">Find where you can buy at a discount</p>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Search (no language/publisher tabs) -->
    <form id="searchForm" class="bg-white border rounded-2xl p-4 shadow-sm flex gap-3">
      <input id="q" class="flex-1 border rounded-xl px-3 py-2" placeholder="Search by title or author (e.g., Aadujeevitham)" />
      <button class="bg-indigo-600 text-white rounded-xl px-4 py-2 font-medium">Search</button>
    </form>

    <!-- Top Lists (Best Selling) -->
    <section class="mt-8">
      <h2 class="text-lg font-semibold mb-2">Top 5 Best Selling • Malayalam</h2>
      <div id="malayalamTop" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
    </section>

    <section class="mt-8">
      <h2 class="text-lg font-semibold mb-2">Top 5 Best Selling • English</h2>
      <div id="englishTop" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
    </section>

    <!-- Results: Best price -->
    <section class="mt-10">
      <h2 class="text-lg font-semibold mb-2">Best Price per Title</h2>
      <p id="resultMeta" class="text-xs text-slate-500 mb-3"></p>
      <div id="bestGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </section>

   
    <!-- Reviews: fixed 5 links with icons -->
    <section class="mt-12">
      <h2 class="text-lg font-semibold mb-2">Book Reviews</h2>
      <div id="reviewSites" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3"></div>
    </section>
  </main>

  <footer class="mt-16 py-8 text-center text-xs text-slate-500">
    © <span id="yr"></span> Book Price Finder (Demo)
  </footer>

<script>
// ----- helpers -----
const fmtINR = n => '₹' + Number(n).toLocaleString('en-IN');
function imgTag(src, alt, cls=''){
  return `<img loading="lazy" referrerpolicy="no-referrer" src="${src}" alt="${alt}" class="${cls}"/>`;
}
function coverUrl(isbn, titleFallback){
  if(isbn) return `https://covers.openlibrary.org/b/isbn/${encodeURIComponent(isbn)}-L.jpg`;
  return placeholderCover(titleFallback);
}
function placeholderCover(text='Book'){
  const t = encodeURIComponent(text.slice(0,36));
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='880'><rect width='100%' height='100%' fill='#eef2ff'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Inter,Arial' font-size='36' fill='#4338ca'>${t}</text></svg>`;
  return `data:image/svg+xml;charset=utf8,${svg}`;
}

// ----- Top 5 Best Selling (static demo lists) -----
const MALAYALAM_TOP = [
  { title:'Aadujeevitham', author:'Benyamin', img:coverUrl('9788126421062','Aadujeevitham') },
  { title:'Randamoozham', author:'M.T. Vasudevan Nair', img:coverUrl('9788126402719','Randamoozham') },
  { title:'Manjaveyil Maranangal', author:'Benyamin', img:coverUrl('9788126441763','Manjaveyil Maranangal') },
  { title:'Aarachar', author:'K.R. Meera', img:coverUrl('9788126427408','Aarachar') },
  { title:'Oru Desathinte Katha', author:'S.K. Pottekkatt', img:coverUrl('9788126419335','Oru Desathinte Katha') },
];
const ENGLISH_TOP = [
  { title:'The Alchemist', author:'Paulo Coelho', img:coverUrl('9780061122415','The Alchemist') },
  { title:'1984', author:'George Orwell', img:coverUrl('9780451524935','1984') },
  { title:'The Kite Runner', author:'Khaled Hosseini', img:coverUrl('9781594631931','The Kite Runner') },
  { title:'The God of Small Things', author:'Arundhati Roy', img:coverUrl('9780670086067','The God of Small Things') },
  { title:'Sapiens', author:'Yuval Noah Harari', img:coverUrl('9780099590088','Sapiens') },
];

function renderTop(list, elId){
  const el=document.getElementById(elId);
  el.innerHTML=list.map(b=>`
    <div class="bg-white border rounded-xl p-3 hover:shadow">
      ${imgTag(b.img, b.title, 'w-full h-48 object-cover mb-2 rounded')}
      <div class="font-medium line-clamp-2">${b.title}</div>
      <div class="text-xs text-slate-500">${b.author}</div>
    </div>`).join('');
}

// ----- Best Price (simple demo data) -----
const MOCK_ITEMS=[
  { title:'Aadujeevitham', author:'Benyamin', offer:{store:'DC Books', price:230, url:'#'}, img:coverUrl('9788126421062','Aadujeevitham') },
  { title:'Randamoozham', author:'M.T. Vasudevan Nair', offer:{store:'Amazon India', price:199, url:'#'}, img:coverUrl('9788126402719','Randamoozham') },
  { title:'The Alchemist', author:'Paulo Coelho', offer:{store:'Flipkart', price:279, url:'#'}, img:coverUrl('9780061122415','The Alchemist') },
];
function renderBest(){
  const el=document.getElementById('bestGrid');
  el.innerHTML = MOCK_ITEMS.map(it=>`
    <a href='${it.offer.url}' target='_blank' rel='noopener' class='bg-white border rounded-xl p-3 hover:shadow block'>
      ${imgTag(it.img, it.title, 'w-full h-40 object-cover mb-2 rounded')}
      <div class='font-medium line-clamp-2'>${it.title}</div>
      <div class='text-xs text-slate-500'>${it.author}</div>
      <div class='mt-2 text-sm font-semibold'>${fmtINR(it.offer.price)}</div>
      <div class='text-[11px] text-slate-500'>${it.offer.store}</div>
    </a>`).join('');
  document.getElementById('resultMeta').textContent=`${MOCK_ITEMS.length} best deals`;
}


// ----- Reviews: fixed 5 with icons (via Google S2 favicons) -----
const REVIEW_SITES = [
  { name:'The Book Review India', url:'https://www.thebookreviewindia.org' },
  { name:'Indian Book Critics', url:'https://indianbookcritics.in/reviews' },
  { name:'The Last Critic', url:'https://thelastcritic.com/category/book-reviews' },
  { name:'BookGeeks', url:'https://www.bookgeeks.in/category/book-reviews' },
  { name:'Anu Reviews', url:'https://www.anureviews.com/category/books' },
];
function renderReviewSites(){
  const el=document.getElementById('reviewSites');
  el.innerHTML = REVIEW_SITES.map(s=>{
    const u = new URL(s.url);
    const icon = `https://www.google.com/s2/favicons?domain=${u.hostname}&sz=64`;
    return `
      <a href='${s.url}' target='_blank' rel='noopener' class='bg-white border rounded-xl p-3 hover:shadow block text-center'>
        ${imgTag(icon, s.name, 'mx-auto w-12 h-12 mb-2 rounded')}
        <div class='text-sm font-medium ellipsis'>${s.name}</div>
      </a>`;
  }).join('');
}

function doSearch(e){
  if(e) e.preventDefault();
  renderBest();
}

// ----- init -----
(function init(){
  document.getElementById('yr').textContent=new Date().getFullYear();
  document.getElementById('searchForm').addEventListener('submit', doSearch);
  renderTop(MALAYALAM_TOP,'malayalamTop');
  renderTop(ENGLISH_TOP,'englishTop');
  renderBest();
  renderManorama();
  renderReviewSites();
})();
</script>

</body>
</html>
